// --- Mission 4: NPM & child_process ---
window.myRunNpmDemo = async () => {
    const myTerminal = document.getElementById('term4');
    myTerminal.innerText = "> Installing 'cowsay' via npm (this takes a moment)...";
    
    // Install the package inside the browser container!
    const myInstall = await myWebContainer.spawn('npm', ['install', 'cowsay']);
    await myInstall.exit;

    const myCode = `
        const cowsay = require('cowsay');
        console.log(cowsay.say({ text: "I am running in a browser!", e: "oO", T: "U " }));
    `;
    myRunScript(myCode, 'term4');
};

// --- Mission 5: URL Parser ---
window.myRunUrlDemo = () => {
    const myCode = `
        const url = require('url');
        const myAddress = 'https://render.com/docs/blueprints?query=node#setup';
        const myParsed = url.parse(myAddress, true);
        console.log('Host:', myParsed.host);
        console.log('Path:', myParsed.pathname);
        console.log('Query:', myParsed.query);
    `;
    myRunScript(myCode, 'term5');
};

// --- Mission 6: Path Resolver ---
window.myRunPathDemo = () => {
    const myCode = `
        const path = require('path');
        const myResult = path.resolve('users', 'student', 'projects', 'ai_lab.js');
        console.log('Resolved System Path:', myResult);
        console.log('File Extension:', path.extname(myResult));
    `;
    myRunScript(myCode, 'term6');
};

// --- Mission 7: Event Emitter ---
window.myRunEventsDemo = () => {
    const myCode = `
        const EventEmitter = require('events');
        const myEmitter = new EventEmitter();
        
        myEmitter.on('myAlarm', (myTime) => {
            console.log('ðŸ”” Alarm Triggered at: ' + myTime);
        });

        console.log('Setting alarm...');
        myEmitter.emit('myAlarm', new Date().toLocaleTimeString());
    `;
    myRunScript(myCode, 'term7');
};

// --- Mission 8: Buffer Lab ---
window.myRunBufferDemo = () => {
    const myCode = `
        const myBuf = Buffer.from('Node.js is Awesome');
        console.log('Hex Format:', myBuf.toString('hex'));
        console.log('Base64 Format:', myBuf.toString('base64'));
        console.log('Back to String:', myBuf.toString());
    `;
    myRunScript(myCode, 'term8');
};
